(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[989],{2726:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/feature-flags",function(){return s(7439)}])},7439:function(e,n,s){"use strict";s.r(n),s.d(n,{__toc:function(){return r}});var t=s(7758),i=s(6622),a=s(4242),o=s(9872);s(1328);var l=s(4197);let r=[{depth:2,value:"Syntax for Specifying Flags",id:"syntax-for-specifying-flags"},{depth:2,value:"How It Works",id:"how-it-works"},{depth:2,value:"Benefits",id:"benefits"},{depth:2,value:"Fine-Tuning the Removal",id:"fine-tuning-the-removal"},{depth:3,value:"Example",id:"example"},{depth:2,value:"Node.js note",id:"nodejs-note"},{depth:3,value:"Disable example",id:"disable-example"}];function _createMdxContent(e){let n=Object.assign({h1:"h1",p:"p",code:"code",h2:"h2",ul:"ul",li:"li",ol:"ol",strong:"strong",h3:"h3",pre:"pre",span:"span",a:"a"},(0,l.a)(),e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{children:"Feature Flags"}),"\n",(0,t.jsxs)(n.p,{children:["Feature flags are used to enable or disable specific features provided. The ",(0,t.jsx)(n.code,{children:"features"})," option in the configuration allows you to control the availability of these features."]}),"\n",(0,t.jsx)(n.h2,{id:"syntax-for-specifying-flags",children:"Syntax for Specifying Flags"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"true"}),": Enables the feature for all files."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"false"}),": Disables the feature for all files."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'"glob"'}),": Enables the feature only for files that match the specified glob pattern."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'["glob1", "glob2"]'}),": Enables the feature for files matching any of the specified glob patterns."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:'["glob1", "!glob2"]'}),": Enables the feature for files matching ",(0,t.jsx)(n.code,{children:"glob1"})," but excludes files that match ",(0,t.jsx)(n.code,{children:"glob2"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.h1,{children:[(0,t.jsx)(n.code,{children:"dangerousCodeRemover"})," Feature"]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"dangerousCodeRemover"})," is a flag that is enabled by default. It is designed to enhance the static evaluation of values that are interpolated in styles and to optimize the processing of styled-wrapped components during the build stage. This optimization is crucial for maintaining a stable and fast build process. It is important to note that the ",(0,t.jsx)(n.code,{children:"dangerousCodeRemover"})," does not impact the runtime code; it solely focuses on the code used during the build."]}),"\n",(0,t.jsx)(n.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,t.jsxs)(n.p,{children:["During the build process, WyW-in-JS statically analyzes the CSS-in-JS codebase and evaluates the styles and values that are being interpolated. The ",(0,t.jsx)(n.code,{children:"dangerousCodeRemover"})," steps in at this stage to remove potentially unsafe code, which includes code that might interact with browser-specific APIs, make HTTP requests, or perform other runtime-specific operations. By removing such code, the evaluation becomes more reliable, predictable, and efficient."]}),"\n",(0,t.jsx)(n.h2,{id:"benefits",children:"Benefits"}),"\n",(0,t.jsxs)(n.p,{children:["Enabling the ",(0,t.jsx)(n.code,{children:"dangerousCodeRemover"})," feature provides several benefits:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Stability"}),": The removal of potentially unsafe code ensures that the build process remains stable. It minimizes the chances of encountering build-time errors caused by unsupported browser APIs or non-static operations."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Performance"}),": Removing unnecessary code results in faster build times. The build tool can efficiently process and evaluate the styles and components without unnecessary overhead, leading to quicker development cycles."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"fine-tuning-the-removal",children:"Fine-Tuning the Removal"}),"\n",(0,t.jsxs)(n.p,{children:["While the ",(0,t.jsx)(n.code,{children:"dangerousCodeRemover"})," is highly effective at optimizing the build process, there may be cases where it becomes overly aggressive and removes code that is actually required for your specific use case. In such situations, you have the flexibility to fine-tune the behavior of the remover."]}),"\n",(0,t.jsxs)(n.p,{children:["By leveraging the ",(0,t.jsx)(n.code,{children:"features"})," option in the configuration, you can selectively disable the ",(0,t.jsx)(n.code,{children:"dangerousCodeRemover"})," for specific files. This allows you to preserve valuable code that may not be safely evaluated during the build process."]}),"\n",(0,t.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,t.jsxs)(n.p,{children:["Suppose you have a file named ",(0,t.jsx)(n.code,{children:"specialComponent.js"})," that contains code that should not be deleted. By adding the following entry to your ",(0,t.jsx)(n.code,{children:"features"})," configuration:"]}),"\n",(0,t.jsx)(n.pre,{"data-language":"js","data-theme":"default",children:(0,t.jsxs)(n.code,{"data-language":"js","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  features"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    dangerousCodeRemover"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"**/*"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"!**/specialComponent.js"'}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  }"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,t.jsxs)(n.p,{children:["You are instructing WyW-in-JS to exclude the ",(0,t.jsx)(n.code,{children:"specialComponent.js"})," file from the removal process. As a result, any code within this file that would have been removed by the ",(0,t.jsx)(n.code,{children:"dangerousCodeRemover"})," will be retained in the build output."]}),"\n",(0,t.jsxs)(n.h1,{children:[(0,t.jsx)(n.code,{children:"globalCache"})," Feature"]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"globalCache"})," is enabled by default. WyW-in-JS uses two levels of caching to improve the performance of the build process. The first level is used to cache transformation and evaluation results for each ",(0,t.jsx)(n.code,{children:"transform"})," call, usually a single call of Webpack's loader or Vite's transform hook. The second level is used to cache the results of the entire build process. The ",(0,t.jsx)(n.code,{children:"globalCache"})," feature controls the second level of caching. Turning off this feature will result in a slower build process but decreased memory usage."]}),"\n",(0,t.jsxs)(n.h1,{children:[(0,t.jsx)(n.code,{children:"happyDOM"})," Feature"]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"happyDOM"})," is enabled by default. This feature enables usage of ",(0,t.jsx)(n.a,{href:"https://github.com/capricorn86/happy-dom",children:"https://github.com/capricorn86/happy-dom"})," to emulate a browser environment during the build process. Typically, the ",(0,t.jsx)(n.code,{children:"dangerousCodeRemover"})," feature should remove all browser-related code. However, some libraries may still contain browser-specific code that cannot be statically evaluated. In such cases, the ",(0,t.jsx)(n.code,{children:"happyDOM"})," feature can be used to emulate a browser environment during the build process. This allows WyW-in-JS to evaluate the code without encountering errors caused by missing browser APIs."]}),"\n",(0,t.jsx)(n.h2,{id:"nodejs-note",children:"Node.js note"}),"\n",(0,t.jsxs)(n.p,{children:["As of ",(0,t.jsx)(n.code,{children:"happy-dom@20"}),", the package is ",(0,t.jsx)(n.strong,{children:"ESM-only"}),". WyW-in-JS is currently published as ",(0,t.jsx)(n.strong,{children:"CJS"}),", so on Node versions where\n",(0,t.jsx)(n.code,{children:"require()"})," cannot load ESM (for example Node 20/22) WyW-in-JS will skip DOM emulation and print a one-time warning."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["To silence the warning (and make the behavior explicit): ",(0,t.jsx)(n.code,{children:"features: { happyDOM: false }"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["For “real” DOM emulation in Node 20+, WyW-in-JS needs an ESM-only eval architecture (planned for v2.0.0), or a runtime\nthat supports ",(0,t.jsx)(n.code,{children:"require(ESM)"})," (Node 24+)."]}),"\n"]}),"\n",(0,t.jsxs)(n.h1,{children:[(0,t.jsx)(n.code,{children:"softErrors"})," Feature"]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"softErrors"})," is disabled by default. It is designed to provide a more lenient evaluation of styles and values that are interpolated in styles. This flag is useful for debugging and prevents the build from failing even if some files cannot be processed with WyW-in-JS."]}),"\n",(0,t.jsx)(n.h1,{children:"'useBabelConfigs' Feature"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"useBabelConfigs"})," feature is enabled by default. If it is enabled, WyW-in-JS will try to resolve the ",(0,t.jsx)(n.code,{children:".babelrc"})," file for each processed file. Otherwise, it will use the default Babel configuration from ",(0,t.jsx)(n.code,{children:"babelOptions"})," in the configuration."]}),"\n",(0,t.jsxs)(n.p,{children:["Please note that the default value of ",(0,t.jsx)(n.code,{children:"useBabelConfigs"})," will be changed to ",(0,t.jsx)(n.code,{children:"false"})," in the next major release."]}),"\n",(0,t.jsxs)(n.h1,{children:[(0,t.jsx)(n.code,{children:"useWeakRefInEval"})," Feature"]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"useWeakRefInEval"})," feature is enabled by default. With it on, WyW-in-JS wraps evaluated modules in ",(0,t.jsx)(n.code,{children:"WeakRef"})," to reduce memory usage during long-running builds. Garbage collection can reclaim these weak references in some environments, which may surface as ",(0,t.jsx)(n.code,{children:"EvalError: Module X is disposed"})," when a disposed module is accessed again. If you encounter that error pattern, disable this flag to keep strong references (at the cost of higher memory usage)."]}),"\n",(0,t.jsxs)(n.p,{children:["See: ",(0,t.jsx)(n.a,{href:"https://github.com/callstack/linaria/issues/1352",children:"callstack/linaria#1352"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"disable-example",children:"Disable example"}),"\n",(0,t.jsx)(n.pre,{"data-language":"js","data-theme":"default",children:(0,t.jsxs)(n.code,{"data-language":"js","data-theme":"default",children:[(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{"})}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  features"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    useWeakRefInEval"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:":"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"false"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsxs)(n.span,{className:"line",children:[(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  }"}),(0,t.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,t.jsx)(n.span,{className:"line",children:(0,t.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})})]})}let d={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,l.a)(),e.components);return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/feature-flags.mdx",route:"/feature-flags",timestamp:1769437491e3,pageMap:[{kind:"Meta",data:{index:"Introduction",stability:"Stability",troubleshooting:"Troubleshooting","how-it-works":"How it works?","how-to":"How to use",bundlers:"Supported bundlers",cli:"CLI",changelog:"Changelog",configuration:"Configuration","feature-flags":"Feature Flags"}},{kind:"Folder",name:"bundlers",route:"/bundlers",children:[{kind:"MdxPage",name:"bun",route:"/bundlers/bun"},{kind:"MdxPage",name:"esbuild",route:"/bundlers/esbuild"},{kind:"MdxPage",name:"index",route:"/bundlers"},{kind:"MdxPage",name:"nextjs",route:"/bundlers/nextjs"},{kind:"MdxPage",name:"parcel",route:"/bundlers/parcel"},{kind:"MdxPage",name:"rollup",route:"/bundlers/rollup"},{kind:"MdxPage",name:"rspack",route:"/bundlers/rspack"},{kind:"MdxPage",name:"svelte",route:"/bundlers/svelte"},{kind:"MdxPage",name:"vite",route:"/bundlers/vite"},{kind:"MdxPage",name:"webpack",route:"/bundlers/webpack"},{kind:"Meta",data:{bun:"Bun",esbuild:"Esbuild",index:"Index",nextjs:"Nextjs",parcel:"Parcel",rollup:"Rollup",rspack:"Rspack",svelte:"Svelte",vite:"Vite",webpack:"Webpack"}}]},{kind:"MdxPage",name:"changelog",route:"/changelog"},{kind:"MdxPage",name:"cli",route:"/cli"},{kind:"MdxPage",name:"configuration",route:"/configuration"},{kind:"Folder",name:"debug",route:"/debug",children:[{kind:"Meta",data:{"log-analyzer":"Log analyzer"}},{kind:"MdxPage",name:"log-analyzer",route:"/debug/log-analyzer",frontMatter:{title:"Log analyzer",layout:"raw",navbar:!1,sidebar:!1,toc:!1,pagination:!1,breadcrumb:!1}}]},{kind:"MdxPage",name:"feature-flags",route:"/feature-flags"},{kind:"MdxPage",name:"how-it-works",route:"/how-it-works"},{kind:"Folder",name:"how-to",route:"/how-to",children:[{kind:"MdxPage",name:"bundler-agnostic",route:"/how-to/bundler-agnostic"},{kind:"MdxPage",name:"custom-tagged-template",route:"/how-to/custom-tagged-template"},{kind:"Meta",data:{"bundler-agnostic":"Bundler Agnostic","custom-tagged-template":"Custom Tagged Template"}}]},{kind:"MdxPage",name:"index",route:"/"},{kind:"MdxPage",name:"stability",route:"/stability"},{kind:"MdxPage",name:"troubleshooting",route:"/troubleshooting"}],flexsearch:{codeblocks:!0},title:"Feature Flags",headings:r},pageNextRoute:"/feature-flags",nextraLayout:a.ZP,themeConfig:o.Z};n.default=(0,i.j)(d)},9872:function(e,n,s){"use strict";var t=s(7758);n.Z={footer:{component:null},logo:(0,t.jsx)("span",{children:"WyW-in-JS"}),primaryHue:210,primarySaturation:100,docsRepositoryBase:"https://github.com/Anber/wyw-in-js/tree/main/apps/website",project:{link:"https://github.com/Anber/wyw-in-js"},useNextSeoProps:()=>({titleTemplate:"%s – WyW-in-JS"})}},1801:function(){}},function(e){e.O(0,[774,471,888,179],function(){return e(e.s=2726)}),_N_E=e.O()}]);